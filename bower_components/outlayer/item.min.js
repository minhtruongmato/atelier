(function(b,a){if(typeof define=="function"&&define.amd){define(["ev-emitter/ev-emitter","get-size/get-size"],a)}else{if(typeof module=="object"&&module.exports){module.exports=a(require("ev-emitter"),require("get-size"))}else{b.Outlayer={};b.Outlayer.Item=a(b.EvEmitter,b.getSize)}}}(window,function factory(b,n){function m(o){for(var p in o){return false}p=null;return true}var h=document.documentElement.style;var l=typeof h.transition=="string"?"transition":"WebkitTransition";var i=typeof h.transform=="string"?"transform":"WebkitTransform";var a={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[l];var j={transform:i,transition:l,transitionDuration:l+"Duration",transitionProperty:l+"Property"};function c(o,p){if(!o){return}this.element=o;this.layout=p;this.position={x:0,y:0};this._create()}var e=c.prototype=Object.create(b.prototype);e.constructor=c;e._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}};this.css({position:"absolute"})};e.handleEvent=function(o){var p="on"+o.type;if(this[p]){this[p](o)}};e.getSize=function(){this.size=n(this.element)};e.css=function(q){var o=this.element.style;for(var r in q){var p=j[r]||r;o[p]=q[r]}};e.getPosition=function(){var s=getComputedStyle(this.element);var v=this.layout._getOption("originLeft");var u=this.layout._getOption("originTop");var r=s[v?"left":"right"];var q=s[u?"top":"bottom"];var p=this.layout.size;var o=r.indexOf("%")!=-1?(parseFloat(r)/100)*p.width:parseInt(r,10);var t=q.indexOf("%")!=-1?(parseFloat(q)/100)*p.height:parseInt(q,10);o=isNaN(o)?0:o;t=isNaN(t)?0:t;o-=v?p.paddingLeft:p.paddingRight;t-=u?p.paddingTop:p.paddingBottom;this.position.x=o;this.position.y=t};e.layoutPosition=function(){var q=this.layout.size;var p={};var A=this.layout._getOption("originLeft");var B=this.layout._getOption("originTop");var w=A?"paddingLeft":"paddingRight";var r=A?"left":"right";var s=A?"right":"left";var v=this.position.x+q[w];p[r]=this.getXValue(v);p[s]="";var t=B?"paddingTop":"paddingBottom";var z=B?"top":"bottom";var o=B?"bottom":"top";var u=this.position.y+q[t];p[z]=this.getYValue(u);p[o]="";this.css(p);this.emitEvent("layout",[this])};e.getXValue=function(o){var p=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!p?((o/this.layout.size.width)*100)+"%":o+"px"};e.getYValue=function(p){var o=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&o?((p/this.layout.size.height)*100)+"%":p+"px"};e._transitionTo=function(z,w){this.getPosition();var p=this.position.x;var o=this.position.y;var v=parseInt(z,10);var u=parseInt(w,10);var t=v===this.position.x&&u===this.position.y;this.setPosition(z,w);if(t&&!this.isTransitioning){this.layoutPosition();return}var s=z-p;var r=w-o;var q={};q.transform=this.getTranslate(s,r);this.transition({to:q,onTransitionEnd:{transform:this.layoutPosition},isCleaning:true})};e.getTranslate=function(o,r){var q=this.layout._getOption("originLeft");var p=this.layout._getOption("originTop");o=q?o:-o;r=p?r:-r;return"translate3d("+o+"px, "+r+"px, 0)"};e.goTo=function(o,p){this.setPosition(o,p);this.layoutPosition()};e.moveTo=e._transitionTo;e.setPosition=function(o,p){this.position.x=parseInt(o,10);this.position.y=parseInt(p,10)};e._nonTransition=function(o){this.css(o.to);if(o.isCleaning){this._removeStyles(o.to)}for(var p in o.onTransitionEnd){o.onTransitionEnd[p].call(this)}};e.transition=function(o){if(!parseFloat(this.layout.options.transitionDuration)){this._nonTransition(o);return}var q=this._transn;for(var r in o.onTransitionEnd){q.onEnd[r]=o.onTransitionEnd[r]}for(r in o.to){q.ingProperties[r]=true;if(o.isCleaning){q.clean[r]=true}}if(o.from){this.css(o.from);var p=this.element.offsetHeight;p=null}this.enableTransition(o.to);this.css(o.to);this.isTransitioning=true};function g(o){return o.replace(/([A-Z])/g,function(p){return"-"+p.toLowerCase()})}var k="opacity,"+g(i);e.enableTransition=function(){if(this.isTransitioning){return}this.css({transitionProperty:k,transitionDuration:this.layout.options.transitionDuration});this.element.addEventListener(a,this,false)};e.onwebkitTransitionEnd=function(o){this.ontransitionend(o)};e.onotransitionend=function(o){this.ontransitionend(o)};var d={"-webkit-transform":"transform"};e.ontransitionend=function(r){if(r.target!==this.element){return}var q=this._transn;var o=d[r.propertyName]||r.propertyName;delete q.ingProperties[o];if(m(q.ingProperties)){this.disableTransition()}if(o in q.clean){this.element.style[r.propertyName]="";delete q.clean[o]}if(o in q.onEnd){var p=q.onEnd[o];p.call(this);delete q.onEnd[o]}this.emitEvent("transitionEnd",[this])};e.disableTransition=function(){this.removeTransitionStyles();this.element.removeEventListener(a,this,false);this.isTransitioning=false};e._removeStyles=function(p){var o={};for(var q in p){o[q]=""}this.css(o)};var f={transitionProperty:"",transitionDuration:""};e.removeTransitionStyles=function(){this.css(f)};e.removeElem=function(){this.element.parentNode.removeChild(this.element);this.css({display:""});this.emitEvent("remove",[this])};e.remove=function(){if(!l||!parseFloat(this.layout.options.transitionDuration)){this.removeElem();return}this.once("transitionEnd",function(){this.removeElem()});this.hide()};e.reveal=function(){delete this.isHidden;this.css({display:""});var p=this.layout.options;var q={};var o=this.getHideRevealTransitionEndProperty("visibleStyle");q[o]=this.onRevealTransitionEnd;this.transition({from:p.hiddenStyle,to:p.visibleStyle,isCleaning:true,onTransitionEnd:q})};e.onRevealTransitionEnd=function(){if(!this.isHidden){this.emitEvent("reveal")}};e.getHideRevealTransitionEndProperty=function(p){var o=this.layout.options[p];if(o.opacity){return"opacity"}for(var q in o){return q}};e.hide=function(){this.isHidden=true;this.css({display:""});var p=this.layout.options;var q={};var o=this.getHideRevealTransitionEndProperty("hiddenStyle");q[o]=this.onHideTransitionEnd;this.transition({from:p.visibleStyle,to:p.hiddenStyle,isCleaning:true,onTransitionEnd:q})};e.onHideTransitionEnd=function(){if(this.isHidden){this.css({display:"none"});this.emitEvent("hide")}};e.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})};return c}));