/*!
 * Outlayer v2.0.1
 * the brains and guts of a layout library
 * MIT license
 */
(function(b,a){if(typeof define=="function"&&define.amd){define(["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(c,f,d,e){return a(b,c,f,d,e)})}else{if(typeof module=="object"&&module.exports){module.exports=a(b,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item"))}else{b.Outlayer=a(b,b.EvEmitter,b.getSize,b.fizzyUIUtils,b.Outlayer.Item)}}}(window,function factory(i,b,l,j,d){var e=i.console;var m=i.jQuery;var k=function(){};var h=0;var a={};function g(q,o){var n=j.getQueryElement(q);if(!n){if(e){e.error("Bad element for "+this.constructor.namespace+": "+(n||q))}return}this.element=n;if(m){this.$element=m(this.element)}this.options=j.extend({},this.constructor.defaults);this.option(o);var r=++h;this.element.outlayerGUID=r;a[r]=this;this._create();var p=this._getOption("initLayout");if(p){this.layout()}}g.namespace="outlayer";g.Item=d;g.defaults={containerStyle:{position:"relative"},initLayout:true,originLeft:true,originTop:true,resize:true,resizeContainer:true,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var f=g.prototype;j.extend(f,b.prototype);f.option=function(n){j.extend(this.options,n)};f._getOption=function(o){var n=this.constructor.compatOptions[o];return n&&this.options[n]!==undefined?this.options[n]:this.options[o]};g.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"};f._create=function(){this.reloadItems();this.stamps=[];this.stamp(this.options.stamp);j.extend(this.element.style,this.options.containerStyle);var n=this._getOption("resize");if(n){this.bindResize()}};f.reloadItems=function(){this.items=this._itemize(this.element.children)};f._itemize=function(o){var r=this._filterFindItemElements(o);var p=this.constructor.Item;var n=[];for(var q=0;q<r.length;q++){var t=r[q];var s=new p(t,this);n.push(s)}return n};f._filterFindItemElements=function(n){return j.filterFindElements(n,this.options.itemSelector)};f.getItemElements=function(){return this.items.map(function(n){return n.element})};f.layout=function(){this._resetLayout();this._manageStamps();var n=this._getOption("layoutInstant");var o=n!==undefined?n:!this._isLayoutInited;this.layoutItems(this.items,o);this._isLayoutInited=true};f._init=f.layout;f._resetLayout=function(){this.getSize()};f.getSize=function(){this.size=l(this.element)};f._getMeasurement=function(p,n){var o=this.options[p];var q;if(!o){this[p]=0}else{if(typeof o=="string"){q=this.element.querySelector(o)}else{if(o instanceof HTMLElement){q=o}}this[p]=q?l(q)[n]:o}};f.layoutItems=function(n,o){n=this._getItemsForLayout(n);this._layoutItems(n,o);this._postLayout()};f._getItemsForLayout=function(n){return n.filter(function(o){return !o.isIgnored})};f._layoutItems=function(o,p){this._emitCompleteOnItems("layout",o);if(!o||!o.length){return}var n=[];o.forEach(function(r){var q=this._getItemLayoutPosition(r);q.item=r;q.isInstant=p||r.isLayoutInstant;n.push(q)},this);this._processLayoutQueue(n)};f._getItemLayoutPosition=function(){return{x:0,y:0}};f._processLayoutQueue=function(n){n.forEach(function(o){this._positionItem(o.item,o.x,o.y,o.isInstant)},this)};f._positionItem=function(o,n,q,p){if(p){o.goTo(n,q)}else{o.moveTo(n,q)}};f._postLayout=function(){this.resizeContainer()};f.resizeContainer=function(){var o=this._getOption("resizeContainer");if(!o){return}var n=this._getContainerSize();if(n){this._setContainerMeasure(n.width,true);this._setContainerMeasure(n.height,false)}};f._getContainerSize=k;f._setContainerMeasure=function(n,o){if(n===undefined){return}var p=this.size;if(p.isBorderBox){n+=o?p.paddingLeft+p.paddingRight+p.borderLeftWidth+p.borderRightWidth:p.paddingBottom+p.paddingTop+p.borderTopWidth+p.borderBottomWidth}n=Math.max(n,0);this.element.style[o?"width":"height"]=n+"px"};f._emitCompleteOnItems=function(o,n){var t=this;function s(){t.dispatchEvent(o+"Complete",null,[n])}var r=n.length;if(!n||!r){s();return}var p=0;function q(){p++;if(p==r){s()}}n.forEach(function(u){u.once(o,q)})};f.dispatchEvent=function(q,r,o){var p=r?[r].concat(o):o;this.emitEvent(q,p);if(m){this.$element=this.$element||m(this.element);if(r){var n=m.Event(r);n.type=q;this.$element.trigger(n,o)}else{this.$element.trigger(q,o)}}};f.ignore=function(o){var n=this.getItem(o);if(n){n.isIgnored=true}};f.unignore=function(o){var n=this.getItem(o);if(n){delete n.isIgnored}};f.stamp=function(n){n=this._find(n);if(!n){return}this.stamps=this.stamps.concat(n);n.forEach(this.ignore,this)};f.unstamp=function(n){n=this._find(n);if(!n){return}n.forEach(function(o){j.removeFrom(this.stamps,o);this.unignore(o)},this)};f._find=function(n){if(!n){return}if(typeof n=="string"){n=this.element.querySelectorAll(n)}n=j.makeArray(n);return n};f._manageStamps=function(){if(!this.stamps||!this.stamps.length){return}this._getBoundingRect();this.stamps.forEach(this._manageStamp,this)};f._getBoundingRect=function(){var n=this.element.getBoundingClientRect();var o=this.size;this._boundingRect={left:n.left+o.paddingLeft+o.borderLeftWidth,top:n.top+o.paddingTop+o.borderTopWidth,right:n.right-(o.paddingRight+o.borderRightWidth),bottom:n.bottom-(o.paddingBottom+o.borderBottomWidth)}};f._manageStamp=k;f._getElementOffset=function(q){var n=q.getBoundingClientRect();var p=this._boundingRect;var o=l(q);var r={left:n.left-p.left-o.marginLeft,top:n.top-p.top-o.marginTop,right:p.right-n.right-o.marginRight,bottom:p.bottom-n.bottom-o.marginBottom};return r};f.handleEvent=j.handleEvent;f.bindResize=function(){i.addEventListener("resize",this);this.isResizeBound=true};f.unbindResize=function(){i.removeEventListener("resize",this);this.isResizeBound=false};f.onresize=function(){this.resize()};j.debounceMethod(g,"onresize",100);f.resize=function(){if(!this.isResizeBound||!this.needsResizeLayout()){return}this.layout()};f.needsResizeLayout=function(){var o=l(this.element);var n=this.size&&o;return n&&o.innerWidth!==this.size.innerWidth};f.addItems=function(o){var n=this._itemize(o);if(n.length){this.items=this.items.concat(n)}return n};f.appended=function(o){var n=this.addItems(o);if(!n.length){return}this.layoutItems(n,true);this.reveal(n)};f.prepended=function(o){var n=this._itemize(o);if(!n.length){return}var p=this.items.slice(0);this.items=n.concat(p);this._resetLayout();this._manageStamps();this.layoutItems(n,true);this.reveal(n);this.layoutItems(p)};f.reveal=function(n){this._emitCompleteOnItems("reveal",n);if(!n||!n.length){return}n.forEach(function(o){o.reveal()})};f.hide=function(n){this._emitCompleteOnItems("hide",n);if(!n||!n.length){return}n.forEach(function(o){o.hide()})};f.revealItemElements=function(o){var n=this.getItems(o);this.reveal(n)};f.hideItemElements=function(o){var n=this.getItems(o);this.hide(n)};f.getItem=function(p){for(var n=0;n<this.items.length;n++){var o=this.items[n];if(o.element==p){return o}}};f.getItems=function(o){o=j.makeArray(o);var n=[];o.forEach(function(q){var p=this.getItem(q);if(p){n.push(p)}},this);return n};f.remove=function(n){var o=this.getItems(n);this._emitCompleteOnItems("remove",o);if(!o||!o.length){return}o.forEach(function(p){p.remove();j.removeFrom(this.items,p)},this)};f.destroy=function(){var n=this.element.style;n.height="";n.position="";n.width="";this.items.forEach(function(p){p.destroy()});this.unbindResize();var o=this.element.outlayerGUID;delete a[o];delete this.element.outlayerGUID;if(m){m.removeData(this.element,this.constructor.namespace)}};g.data=function(n){n=j.getQueryElement(n);var o=n&&n.outlayerGUID;return o&&a[o]};g.create=function(p,n){var o=c(g);o.defaults=j.extend({},g.defaults);j.extend(o.defaults,n);o.compatOptions=j.extend({},g.compatOptions);o.namespace=p;o.data=g.data;o.Item=c(d);j.htmlInit(o,p);if(m&&m.bridget){m.bridget(p,o)}return o};function c(n){function o(){n.apply(this,arguments)}o.prototype=Object.create(n.prototype);o.prototype.constructor=o;return o}g.Item=d;return g}));